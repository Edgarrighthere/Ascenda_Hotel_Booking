"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("fastest-levenshtein"),t=require("lodash.deburr");let s=function(e){return e.ALL_CLOSEST_MATCHES="all-closest-matches",e.ALL_MATCHES="all-matches",e.ALL_SORTED_MATCHES="all-sorted-matches",e.FIRST_CLOSEST_MATCH="first-closest-match",e.FIRST_MATCH="first-match",e}({}),r=function(e){return e.EDIT_DISTANCE="edit-distance",e.SIMILARITY="similarity",e}({});const c=(e,s)=>{let r=e;return s.trimSpaces&&(r=r.trim().replaceAll(/\s+/gu," ")),s.deburr&&(r=t(r)),s.caseSensitive||(r=r.toLowerCase()),r},n=(e,t)=>{const{matchPath:s}=t,r=((e,t)=>{const s=t.length>0?t.reduce(((e,t)=>e?.[t]),e):e;return"string"!=typeof s?"":s})(e,s);return c(r,t)};exports.ReturnTypeEnums=s,exports.ThresholdTypeEnums=r,exports.default=function(t,o,T){const a=(e=>{const t={caseSensitive:!1,deburr:!0,matchPath:[],returnType:s.FIRST_CLOSEST_MATCH,thresholdType:r.SIMILARITY,trimSpaces:!0,...e};if(!Object.values(s).includes(t.returnType))throw new TypeError("unknown returnType");if(!Object.values(r).includes(t.thresholdType))throw new TypeError("unknown thresholdType");switch(t.thresholdType){case r.EDIT_DISTANCE:return{threshold:20,...t};case r.SIMILARITY:return{threshold:.4,...t}}})(T),{returnType:u,threshold:S,thresholdType:h}=a,i=c(t,a);let l,I;switch(h){case r.EDIT_DISTANCE:l=e=>e<=S,I=t=>e.distance(i,n(t,a));break;case r.SIMILARITY:l=e=>e>=S,I=t=>((t,s)=>{if(!t||!s)return 0;if(t===s)return 1;const r=e.distance(t,s),c=Math.max(t.length,s.length);return(c-r)/c})(i,n(t,a))}const A=[];switch(u){case s.ALL_CLOSEST_MATCHES:case s.FIRST_CLOSEST_MATCH:{const e=[];let t;switch(h){case r.EDIT_DISTANCE:t=Number.POSITIVE_INFINITY;for(const s of o){const r=I(s);t>r&&(t=r),e.push(r)}break;case r.SIMILARITY:t=0;for(const s of o){const r=I(s);t<r&&(t=r),e.push(r)}}for(const[s,r]of e.entries())l(r)&&r===t&&A.push(s);break}case s.ALL_MATCHES:for(const[e,t]of o.entries()){l(I(t))&&A.push(e)}break;case s.ALL_SORTED_MATCHES:{const e=[];for(const[t,s]of o.entries()){const r=I(s);l(r)&&e.push({score:r,index:t})}switch(h){case r.EDIT_DISTANCE:e.sort(((e,t)=>e.score-t.score));break;case r.SIMILARITY:e.sort(((e,t)=>t.score-e.score))}for(const t of e)A.push(t.index);break}case s.FIRST_MATCH:for(const[e,t]of o.entries()){if(l(I(t))){A.push(e);break}}}return((e,t,r)=>{switch(r){case s.ALL_CLOSEST_MATCHES:case s.ALL_MATCHES:case s.ALL_SORTED_MATCHES:return t.map((t=>e[t]));case s.FIRST_CLOSEST_MATCH:case s.FIRST_MATCH:{const s=t[0];return void 0===s?null:e[s]}}})(o,A,u)};
//# sourceMappingURL=index.cjs.map
